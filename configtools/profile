# -*- mode: shell-script -*-
prefix=/opt/configtools

if [[ ! -f $prefix/profile ]]
then
    # Assumes you must have already issued a "make" in the source tree
    if [[ -f $PWD/profile ]]
    then
        prefix=$PWD/build
    else
        # Last ditch attempt
        prefix=$TOP/configtools/build
    fi
fi

pathins() {
    if [ -d "$1" ] && [[ ":$PATH:" != *":$1:"* ]]; then
        PATH="$1:$PATH"
    fi
}
ppathins() {
    if [ -d "$1" ] && [[ ":$PYTHONPATH:" != *":$1:"* ]]; then
        PYTHONPATH="$1:$PYTHONPATH"
    fi
}

# prefix better be right at this point
if [[ ! -f $prefix/bin/getconf.2.py ]]
then
    echo "Cannot find getconf.py"
else
    pathin $prefix/bin

    export PYTHONPATH
    ppathins $prefix/lib

    export CONFIG
    CONFIG=$prefix/CONFIG/configtools.conf
fi
unset prefix
